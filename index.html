<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <title>Tyranids Point Calculator</title>

  <style>
    :root {
      --purple: #9c27b0;
      --purple2: #7b1fa2;
      --red: #d32f2f;
    }

    body {
      font-family: system-ui, -apple-system, "Hiragino Sans", "Noto Sans JP", sans-serif;
      margin: 0;
      background: #fafafa;
    }

    .wrap {
      max-width: 720px;
      margin: 0 auto;
      padding: 24px 16px 40px;
    }

    h1 {
      margin: 8px 0 16px;
      color: var(--purple2);
      letter-spacing: 0.5px;
    }

    .top {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      flex-wrap: wrap;
      gap: 12px;
    }

    .small {
      font-size: 12px;
      color: #666;
    }

    .card {
      background: #fff;
      border: 1px solid #eee;
      border-radius: 14px;
      padding: 16px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.05);
    }

    label {
      font-weight: 700;
      display: block;
      margin-bottom: 8px;
    }

    .row {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      align-items: center;
    }

    select {
      flex: 1 1 280px;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid #ddd;
      font-size: 14px;
    }

    button {
      padding: 10px 14px;
      border-radius: 10px;
      border: 0;
      cursor: pointer;
      font-weight: 700;
      font-size: 14px;
    }

    .btn-add {
      background: var(--purple);
      color: #fff;
    }

    .btn-del {
      background: #eee;
    }

    .list {
      margin-top: 14px;
      border: 1px solid #eee;
      border-radius: 12px;
      overflow: auto;
      min-height: 220px;
      -webkit-overflow-scrolling: touch;
    }

    .item {
      display: flex;
      justify-content: space-between;
      padding: 10px 12px;
      border-top: 1px solid #f1f1f1;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      cursor: pointer;
    }

    .item:first-child {
      border-top: none;
    }

    .item.selected {
      background: #f3e5f5;
    }

    .total {
      margin-top: 16px;
      font-size: 20px;
      font-weight: 800;
      color: var(--red);
    }

    .hint {
      color: #666;
      font-size: 12px;
      margin-top: 10px;
      line-height: 1.5;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="top">
      <h1>Hive Fleet Manager</h1>
      <div class="small">Tyranids Point Calculatorï¼ˆHTML / iPhoneå¯¾å¿œï¼‰</div>
    </div>

    <div class="card">
      <label for="unitSelect">ãƒã‚¤ã‚ªãƒ•ã‚©ãƒ¼ãƒ ã‚’é¸æŠ:</label>
      <div class="row">
        <select id="unitSelect"></select>
        <button class="btn-add" id="addBtn">ç¾¤ã‚Œã«åŠ ãˆã‚‹</button>
        <button class="btn-del" id="removeBtn">å‰Šé™¤</button>
      </div>

      <div class="list" id="list"></div>

      <div class="total" id="total">Total Points: 0</div>

      <div class="hint">
        ãƒ»å‰Šé™¤ã¯ã€ãƒªã‚¹ãƒˆã®è¡Œã‚’ã‚¿ãƒƒãƒ—ã—ã¦é¸æŠã—ã¦ã‹ã‚‰æŠ¼ã—ã¦ãã ã•ã„ã€‚<br>
        ãƒ»ãƒã‚¤ãƒ³ãƒˆã¯æ”¹å®šã•ã‚Œã‚‹ãŸã‚ã€å…¬å¼ã® Munitorum Field Manual ã‚’éšæ™‚ç¢ºèªã—ã¦ãã ã•ã„ã€‚
      </div>
    </div>
  </div>

  <script>
    // Tyranids unit data
    const TYRANIDS_DATA = {
      "Termagants (10ä½“)": 60,
      "Hormagaunts (10ä½“)": 70,
      "Gargoyles (10ä½“)": 80,
      "Neurogaunts (11ä½“)": 45,
      "Genestealers (5ä½“)": 75,
      "Tyranid Warriors (Ranged/3ä½“)": 70,
      "Tyranid Warriors (Melee/3ä½“)": 90,
      "Hive Tyrant": 220,
      "The Swarmlord": 250,
      "Neurotyrant": 105,
      "Old One Eye": 140,
      "Deathleaper": 80,
      "Exocrine": 135,
      "Maleceptor": 165,
      "Tyrannofex": 190,
      "Screamer-Killer": 145,
      "Carnifexes (1ä½“)": 125,
      "Zoanthropes (3ä½“)": 90,
      "Biovore (1ä½“)": 40,
      "Norn Emissary": 275,
      "Norn Assimilator": 290
    };

    const unitSelect = document.getElementById("unitSelect");
    const addBtn = document.getElementById("addBtn");
    const removeBtn = document.getElementById("removeBtn");
    const listEl = document.getElementById("list");
    const totalEl = document.getElementById("total");

    const armyList = [];
    let selectedIndex = -1;

    function initSelect() {
      const names = Object.keys(TYRANIDS_DATA).sort(function(a, b) {
        return a.localeCompare(b, "ja");
      });
      for (let i = 0; i < names.length; i++) {
        const opt = document.createElement("option");
        opt.value = names[i];
        opt.textContent = names[i];
        unitSelect.appendChild(opt);
      }
    }

    function renderList() {
      listEl.innerHTML = "";
      for (let i = 0; i < armyList.length; i++) {
        const item = armyList[i];
        const row = document.createElement("div");
        row.className = "item" + (i === selectedIndex ? " selected" : "");
        row.innerHTML =
          "<span>ğŸ¦  " + escapeHtml(item.name) + "</span>" +
          "<span>" + item.pts + "pts</span>";

        row.addEventListener("click", function() {
          selectedIndex = i;
          renderList();
        });

        listEl.appendChild(row);
      }
      updateTotal();
    }

    function updateTotal() {
      let total = 0;
      for (let i = 0; i < armyList.length; i++) {
        total += armyList[i].pts;
      }
      totalEl.textContent = "Total Points: " + total;
    }

    function addUnit() {
      const name = unitSelect.value;
      const pts = TYRANIDS_DATA[name];
      armyList.push({ name: name, pts: pts });
      selectedIndex = armyList.length - 1;
      renderList();
    }

    function removeUnit() {
      if (selectedIndex < 0 || selectedIndex >= armyList.length) {
        alert("å‰Šé™¤ã™ã‚‹ãƒ¦ãƒ‹ãƒƒãƒˆã‚’ãƒªã‚¹ãƒˆã‹ã‚‰é¸ã‚“ã§ãã ã•ã„");
        return;
      }
      armyList.splice(selectedIndex, 1);
      if (selectedIndex >= armyList.length) {
        selectedIndex = armyList.length - 1;
      }
      renderList();
    }

    // iOS Safari å¯¾å¿œç‰ˆï¼ˆreplaceAll ä¸ä½¿ç”¨ï¼‰
    function escapeHtml(str) {
      return String(str)
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#039;");
    }

    initSelect();
    renderList();

    addBtn.addEventListener("click", addUnit);
    removeBtn.addEventListener("click", removeUnit);
  </script>
</body>
</html>